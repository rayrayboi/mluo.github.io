<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>Supermeng Games</title>
		<meta name="description" content="Game Portfolio" />
		<meta name="keywords" content="games, Unity3d, meng, wpi, portfolio" />
		<meta name="author" content="Meng" />
		<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
		<link rel="stylesheet" type="text/css" href="css/Me_styles.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
		<script href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r73/three.min.js"></script>

	</head>
	<body>
	    <div id="container"></div>
		<header>
				<div class="avatar"><img src="pics/Avatar.png"></div>	
		</header>

		<div class="container">	

		      <a href="GamePortfolio.html" class="unity biliboard electronic">Games</a>
			  <a href="index.html" class="me biliboard electronic">Me</a>
			  <a href="index.html" class="memories biliboard electronic">Memories</a>


			<div class="row footer homepagefooter">
			 Copyright &copy; 2015, Meng Luo (mluo.bupt [at] gmail.com). All rights reserved.
			</div>
		</div><!-- /container -->
		

		
		<script src="js/grid.js"></script>
		<script>
		   var isLarger = true;
           var last, lastTargetId, lastArrow;
		   var lastTopOffset = -99999;
		   if (window.matchMedia('(max-width: 768px)').matches)
           {
	            		console.log("smaller");
						isLarger = false;
                       
           }
	       if (window.matchMedia('(min-width: 768px)').matches)
           {
	            		console.log("larger");
						isLarger = true;
	            		
	       }
           $("div.container >div.main").css("top",$(window).height());
		   
		   
		       $('header >div.avatar >img').mouseover(function (){
		         $(this).attr("src","pics/Avatar_Hover.png");
		
	           });
	
	           $('header >div.avatar >img').mouseleave(function (){
		         $(this).attr("src","pics/Avatar.png");
		
	           });

					
	            $(window).resize(function(){
	            	if (window.matchMedia('(max-width: 768px)').matches)
                    {
	            		console.log("smaller");
						isLarger = false;
						lastArrow.hide();
			            $(lastTargetId).hide();
                       
                    }
	            	if (window.matchMedia('(min-width: 768px)').matches)
                    {
	            		console.log("larger");
						isLarger = true;
	            		
	            	}
	            	
	            });
				

	 	 
           $("div.container >div.content >div.main >div.row >div.Cell >div.thumbnail >a.pic").on('click', function(event){
			  event.preventDefault();
			 if(isLarger){
			  var imgSrc = $(this).find('img').attr('src');
			  var buttonLink = $(this).find('img').attr('data-link');
			  var description = $(this).find('img').attr('data-alt');
			  var title = $(this).find('img').attr('data-title');
			  var targetId = $(this).attr('data-target');
			  console.log("!!!!!!!!!!!!!!!!"+buttonLink);
			  $(targetId).find("div.previewPanel >div.subPanel1 >div.thumbnail >img").fadeOut(150,function(){
			         $(this).attr("src",imgSrc);
			  }).fadeIn(150);
			  $(targetId).find("div.previewPanel >div.subPanel2 >div.thumbnail >div.caption").find("h3").html(title);
			  $(targetId).find("div.previewPanel >div.subPanel2 >div.thumbnail >div.caption").find("p").html(description);
			  $(targetId).find("div.previewPanel >div.subPanel2 >div.thumbnail >div.caption").find("a").attr('href',buttonLink);
			  
			  if(lastArrow){
			    if(imgSrc !== last){
				  lastArrow.hide();
				}
		
			  }
			  
			  if(imgSrc === last||typeof last == 'undefined'){
			   	$(targetId).slideToggle(400);
			  }
			  
			  else{
	              if($(targetId).is(":hidden")){
				     if($(lastTargetId).is(":visible")){
					     $(lastTargetId).slideToggle(400);
					 }
			         $(targetId).slideToggle(400);
			      }
				  else{
				   //just load pics
				  }
			  }

			  $(this).parent().find('.arrow').toggle(); 			
			 
			  if(lastTopOffset!== $(this).offset().top+100){
			    $('html,body').animate({scrollTop: $(this).offset().top+100}, 400);
			  }  
			  
			  last = imgSrc;
              lastArrow = $(this).parent().find('.arrow');
              lastTargetId = targetId;
            }
			
		  });

		  $("div.container >div.content >div.main >div.row >div.Cell >a.close").on('click', function(event){
		    event.preventDefault();

			$(this).parent().parent().slideToggle(400);
			lastArrow.hide();

		  });

           	$("div.container >div.content >div.main >div.row >div.Cell >div.thumbnail").hover(
		        function(){
				  if(!isLarger){
				    var title = $(this).find('img').attr('data-title');
					var content = $(this).find('img').attr('data-alt');
					var buttonLink = $(this).find('img').attr('data-link');
				    $(this).find('.description').find('h3').html(title);
					$(this).find('.description').find('p').html(content);
					$(this).find('.description').find('a').attr('href',buttonLink);
				    $(this).find('.description').slideDown(250);
				  }
					//$(this).find('.description').css("height",$(this).find('img').height()+'px');
					//$(this).find('.description').css("width",$(this).find('img').width()+'px');
		        	

		        },
		        function(){
				  if(!isLarger){
		        	$(this).find('.description').slideUp(250);
				  }
		        }
	       );
		</script>

        <!-- ---------------- Custom Shader Code ------------------------ -->
        <script id="vertexShader" type="x-shader/x-vertex">
        uniform vec3 viewVector;
        uniform float c;
        uniform float p;
        varying float intensity;
        void main() 
        {
            vec3 vNormal = normalize( normalMatrix * normal );
        	vec3 vNormel = normalize( normalMatrix * viewVector );
        	intensity = pow( c - dot(vNormal, vNormel), p );
        	
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        </script>
        
        <!-- fragment shader a.k.a. pixel shader -->
        <script id="fragmentShader" type="x-shader/x-vertex"> 
        uniform vec3 glowColor;
        varying float intensity;
        void main() 
        {
        	vec3 glow = glowColor * intensity;
            gl_FragColor = vec4( glow, 1.0 );
        }
        </script>


		<script>


			var container;

			var camera, scene, renderer;
			var cameraCube, sceneCube;

			var mesh, lightMesh, geometry;
			var spheres = [];

			var directionalLight, pointLight;

			var mouseX = 0;
			var mouseY = 0;

			var windowHalfX = window.innerWidth / 2;
			var windowHalfY = window.innerHeight / 2;

			document.addEventListener( 'mousemove', onDocumentMouseMove, false );

			init();
			animate();

			function init() {

				container = document.getElementById( 'container' );


				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 100000 );
				camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
				camera.position.z = 3200;

				scene = new THREE.Scene();
				var light = new THREE.DirectionalLight( "rgb(255, 255, 255)" );
                light.position.set( 0, 0, 0 ).normalize();
                scene.add(light);

				var geometry = new THREE.SphereBufferGeometry( 10, 16, 16 );

				//var material = new THREE.MeshBasicMaterial( { color: 0xffffff } );
                /*var material = new THREE.MeshPhongMaterial( { 
                                   color: "rgb(0, 0, 180)", 
                                   specular: "rgb(255, 255, 255)",
								   emissive: 1000
                               } );*/
                 var material = new THREE.ShaderMaterial( 
	            {
	                uniforms: 
	            	{ 
	            		"c":   { type: "f", value: 1 },
	            		"p":   { type: "f", value: 1 },
	            		glowColor: { type: "c", value: new THREE.Color("rgb(0, 0, 200)") },
	            		viewVector: { type: "v3", value: camera.position }
	            	},
	            	vertexShader:   document.getElementById( 'vertexShader'   ).textContent,
	            	fragmentShader: document.getElementById( 'fragmentShader' ).textContent,
	            	side: THREE.FrontSide,
	            	blending: THREE.AdditiveBlending,
	            	transparent: true
	            }   );
	            	
	            
				
				for ( var i = 0; i < 100; i ++ ) {

					var mesh = new THREE.Mesh( geometry, material );
                    this.Glow = new THREE.Mesh( geometry.clone(), material.clone() );
							   
					mesh.position.x = Math.random() * 10000 - 5000;
					mesh.position.y = Math.random() * 10000 - 5000;
					mesh.position.z = Math.random() * 10000 - 5000;

					mesh.scale.x = mesh.scale.y = mesh.scale.z = Math.random() * 3 + 1;
                    Glow.position = mesh.position;
	                Glow.scale.multiplyScalar(1.2);
	                
					mesh.add( Glow );
					scene.add( mesh );

					spheres.push( mesh );

				}


				renderer = new THREE.WebGLRenderer({antialias: true});
				renderer.setPixelRatio( window.innerWidth / window.innerHeight );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.autoClear = false;
				container.appendChild( renderer.domElement );

				//

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function onWindowResize() {

				windowHalfX = window.innerWidth / 2,
				windowHalfY = window.innerHeight / 2,

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function onDocumentMouseMove( event ) {

				mouseX = ( event.clientX - windowHalfX ) * 10;
				mouseY = ( event.clientY - windowHalfY ) * 10;

			}

			//

			function animate() {

				requestAnimationFrame( animate );

				render();

			}

			function render() {

				var timer = 0.0001 * Date.now();

				for ( var i = 0, il = spheres.length; i < il; i ++ ) {

					var sphere = spheres[ i ];

					sphere.position.x = 10000 * Math.cos( timer + i );
					sphere.position.z = 10000 * Math.sin( timer + i*1.1 );
					//sphere.position.z = 5000 * Math.sin( timer + i*0.5 );

				}

				camera.position.x += ( mouseX - camera.position.x ) * .01;
				camera.position.y += ( - mouseY - camera.position.y ) * .01;

				camera.lookAt( scene.position );				
				renderer.render( scene, camera );

			}

		</script>		
	</body>
</html>
